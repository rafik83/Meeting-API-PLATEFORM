<VirtualHost *:80>
  ServerAdmin noc@synalabs.com
  DocumentRoot /var/www/vimeet365/public

  <Directory "/var/www/vimeet365/public">
    Options -Indexes +FollowSymLinks
    AllowOverride All
    Require all granted
    # Rewrite rules
    RewriteEngine On
    RewriteCond %{REQUEST_URI}::$1 ^(/.+)/(.*)::\2$
    RewriteRule ^(.*) - [E=BASE:%1]
    RewriteCond %{ENV:REDIRECT_STATUS} ^$
    RewriteRule ^index\.php(/(.*)|$) %{ENV:BASE}/$2 [R=301,L]
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule .? - [L]
    RewriteRule .? %{ENV:BASE}/index.php [L]
    Order allow,deny
    Allow from all
  </Directory>

  <Location "/server-status">
      SetHandler server-status
      Allow from 127.0.0.1
      Allow from 10.0.0.0/8
  </Location>

  <Directory ~ "\.svn">
    Order allow,deny
    Deny from all
  </Directory>

  <Directory ~ "\.git">
    Order allow,deny
    Deny from all
  </Directory>

  LogLevel info
  FileETag none

  SetEnvIf Request_URI "\.(txt|jpg|png|gif|ico|js|css|jsx?|css|woff2?)$" StaticContent

  ErrorLog /var/log/apache2/error.log
  CustomLog /var/log/apache2/access.log combined env=!StaticContent

  SetEnvIf X-Forwarded-Proto https HTTPS=on
  RewriteEngine On

  SSLProxyEngine on
  SSLProxyVerify none
  SSLProxyCheckPeerName off
  SSLProxyCheckPeerExpire off
  SSLProxyCheckPeerCN off
  ProxyVia Off

</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
